<component name="org.nuxeo.ecm.retention.rules.contrib.test">

  <extension target="org.nuxeo.ecm.retention.RetentionService"
    point="rules">
    <rule>
      <id>myTestRuleId</id>
      <begin-condition event="documentModified"
        expression="document.getType()=='Folder'">
      </begin-condition>
      <retention-duration>1Y2M4D</retention-duration> 
      <begin-action>Document.Lock</begin-action>
      <end-action>Document.Unlock</end-action>
    </rule>

    <rule>
      <id>myTestRuleId2</id>
      <begin-condition event="documentModified"
        expression="document.isFolder()">
      </begin-condition>
      <retention-duration>1Y2M4D</retention-duration> 
      <begin-action>Document.Lock</begin-action>
    </rule>

    <rule>
      <id>retentionOnCreation</id>
      <begin-condition event="documentCreated"
        expression="document.getType()=='File'">
      </begin-condition>
      <retention-duration>P1Y2M4D</retention-duration> 
      <begin-action>Document.Lock</begin-action>
      <end-action>Document.Unlock</end-action>
    </rule>

    <rule>
      <id>retentionWithDelay</id>
      <begin-condition expression="document.getType()=='File'">
      </begin-condition>
      <begin-delay>1D</begin-delay>
      <retention-duration>P1D</retention-duration> 
      <begin-action>Document.Lock</begin-action>
      <end-action>Document.Unlock</end-action>
    </rule>

    <rule>
      <id>retentionWithReminder</id>
      <begin-condition expression="document.getType()=='File'">
      </begin-condition>
      <retention-duration>P1Y</retention-duration> 
      <retention-reminder-days>3</retention-reminder-days>
      <begin-action>Document.Lock</begin-action>
      <end-action>Document.Unlock</end-action>
    </rule>
    
     <rule>
      <id>retentionStartsWhenSettingProperty</id>
      <begin-condition expression="document.getPropertyValue('record:min_cutoff_at').before(currentDate)">
      </begin-condition>
      <retention-duration>P1Y</retention-duration> 
      <retention-reminder-days>2</retention-reminder-days>
      <begin-action>Document.Lock</begin-action>
      <end-action>Document.Unlock</end-action>
    </rule>
    
    <rule>
      <id>retentionOnCreationWithDisposalDate</id>
      <begin-condition event="documentCreated" expression="document.getType()=='File'">
      </begin-condition>
      <retention-disposal-date>20991231</retention-disposal-date>
      <begin-action>Document.Lock</begin-action>
      <end-action>Document.Unlock</end-action>
    </rule>
    
    <rule>
      <id>retentionOnCreationWithInvalidDisposalDate</id>
      <begin-condition event="documentCreated" expression="document.getType()=='File'">
      </begin-condition>
      <retention-disposal-date>invalid</retention-disposal-date>
      <begin-action>Document.Lock</begin-action>
      <end-action>Document.Unlock</end-action>
    </rule>
    
    <rule>
      <id>retentionOnCreationWithDisposalDateXpath</id>
      <begin-condition event="documentCreated" expression="document.getType()=='File'">
      </begin-condition>
      <retention-disposal-date-xpath>dc:expired</retention-disposal-date-xpath>
      <begin-action>Document.Lock</begin-action>
      <end-action>Document.Unlock</end-action>
    </rule>
    
    <rule>
      <id>retentionOnCreationWithInvalidDisposalDateXpath</id>
      <begin-condition event="documentCreated" expression="document.getType()=='File'">
      </begin-condition>
      <retention-disposal-date-xpath>invalid:invalid</retention-disposal-date-xpath>
      <begin-action>Document.Lock</begin-action>
      <end-action>Document.Unlock</end-action>
    </rule>
    
    <rule>
      <id>retentionOnCreationWithInvalidDuration</id>
      <begin-condition event="documentCreated" expression="document.getType()=='File'">
      </begin-condition>
      <retention-duration>invalid:invalid</retention-duration>
      <begin-action>Document.Lock</begin-action>
      <end-action>Document.Unlock</end-action>
    </rule>
    
    <rule>
      <id>retentionOnCreationWithDurationAndDisposalDate</id>
      <begin-condition event="documentCreated" expression="document.getType()=='File'">
      </begin-condition>
      <retention-duration>P1Y</retention-duration>
      <retention-disposal-date>20991231</retention-disposal-date>
      <begin-action>Document.Lock</begin-action>
      <end-action>Document.Unlock</end-action>
    </rule>
    
    <rule>
      <id>retentionOnCreationWithDurationAndDisposalDateAndDisposalXpath</id>
      <begin-condition event="documentCreated" expression="document.getType()=='File'">
      </begin-condition>
      <retention-duration>P1Y</retention-duration>
      <retention-disposal-date>20991231</retention-disposal-date>
      <begin-action>Document.Lock</begin-action>
      <end-action>Document.Unlock</end-action>
    </rule>
    
    <rule>
      <id>retentionOnCreationWithEndActionDocumentDelete</id>
      <begin-condition event="documentCreated"
        expression="document.getType()=='File'">
      </begin-condition>
      <retention-duration>P1D</retention-duration>
      <end-action>Document.Delete</end-action>
    </rule>

  </extension>

</component>